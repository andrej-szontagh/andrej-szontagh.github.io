function Animations(){}function loadJSON(e,t){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&"200"==n.status&&t(JSON.parse(n.responseText))},n.send(null)}String.prototype.hashCode=function(){var e,t=0;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+this.charCodeAt(e),t|=0;return t};var YouTubeAPIInitialized=!(Animations.prototype={triggers:[],constructor:Animations,applyLiveCSSAnimations:function(){for(var u=this,e=document.getElementsByTagName("*"),t=e.length;t--;){var n=e[t],i=window.getComputedStyle(n);if(h=i.getPropertyValue("--anim-play")){for(var o=i.getPropertyValue("--anim-init"),a=i.getPropertyValue("--anim-class"),r=i.getPropertyValue("--anim-trigger"),s=i.getPropertyValue("--anim-edge"),l=i.getPropertyValue("--anim-delay-min"),c=i.getPropertyValue("--anim-delay-max"),d=!1,g=0;g<u.triggers.length;g++){if((_=u.triggers[g]).target.contains(n)&&_.anim_play===h&&_.anim_init===o&&_.anim_class===a&&_.anim_trigger===r&&_.anim_edge===s&&_.anim_delay_min===l&&_.anim_delay_max===c){d=!0;break}if(n.contains(_.target)&&_.anim_play===h&&_.anim_init===o&&_.anim_class===a&&_.anim_trigger===r&&_.anim_edge===s&&_.anim_delay_min===l&&_.anim_delay_max===c){u.triggers.splice(g,1);break}}d||u.triggers.push({target:n,anim_play:h,anim_init:o,anim_class:a,anim_trigger:r,anim_edge:s,anim_delay_min:l,anim_delay_max:c})}}function m(){for(var e=[],t=0;t<u.triggers.length;t++){var n=u.triggers[t],i=n.target,o=n.anim_trigger,a=n.anim_init,r=n.anim_class,s=n.anim_play,l=n.anim_edge;isInViewport(o,l)?(a&&i.classList.remove(a),r?i.classList.add(r):i.style.setProperty("animation-name",s)):e.push(n)}u.triggers=e}for(t=0;t<u.triggers.length;t++){var _,b=(_=u.triggers[t]).target,h=_.anim_play;o=_.anim_init,a=_.anim_class,r=_.anim_trigger,s=_.anim_edge,l=_.anim_delay_min,c=_.anim_delay_max;o&&b.classList.add(o),l&&c&&(l=parseFloat(l),c=parseFloat(c),b.style.setProperty("animation-delay",l+(c-l)*Math.random()+"s")),_.anim_trigger=r="self"===r?b:document.getElementById(r),_.anim_edge=s=s?parseFloat(s):0}m(),window.addEventListener("resize",m),window.addEventListener("scroll",m),this.applyLiveCSSAnimations=null},isInViewport:function(e,t){var n=window.innerHeight,i=e.getBoundingClientRect(),o=n*Math.min(t,.4),a=i.top-o,r=i.bottom-o;return!((n-=2*o)<a||r<0)}}),YouTubeAPIPlayersQueue=[],YouTubeAPIPlayers=[];function YouTubeAPIAddPlayer(e){YouTubeAPIPlayersQueue.push(e)}function YouTubeAPIInit(){if(0==YouTubeAPIInitialized){YouTubeAPIInitialized=!0;var e=document.createElement("script");e.id="iframe-api",e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}}function onYouTubeIframeAPIReady(){for(var e=0;e<YouTubeAPIPlayersQueue.length;e++){var t=YouTubeAPIPlayersQueue[e],n=new YT.Player(t.id,t.params);YouTubeAPIPlayers.push(n)}}function Gallery(i,t,e){var a=this;YouTubeAPIInit();var n=document.querySelector("#description-block");function o(){var e=document.querySelectorAll(".gallery-block");if(e)for(var t=0;t<e.length;t++){var n=e[t];0==n.classList.contains("button-hover")&&(n.classList.add("button-hover"),n.classList.add("hidden"),n.setAttribute("button-target","<this> #description-block"),n.setAttribute("button-clear",".gallery-block"),n.addEventListener("onvisible",function(e){var t,n=null,i=e.target.id;if((t=a.json.images[i])?n=t.description:(t=a.json.videos[i])&&(n=t.description),n)if(n=a.json.descriptions[n]){if(a.desc_header.innerHTML=n.name+"<br> ("+n.year+")",a.desc_oneliner.innerHTML=n.oneliner,a.desc_tags.innerHTML="",n.tags)for(var o=0;o<n.tags.length;o++)0<o&&(a.desc_tags.innerHTML+=" - "),a.desc_tags.innerHTML+=n.tags[o]}else a.desc_header.innerHTML="",a.desc_oneliner.innerHTML="",a.desc_tags.innerHTML=""}),n.___callback_open_lightbox=function(e){"gallery-images"===e.target.parentNode.id?a.manager_images.showLightbox(e.target.querySelector("img")):e.target.parentNode.id})}i.updateButtons()}a.desc_header=n.querySelector("h1"),a.desc_oneliner=n.querySelector("p"),a.desc_tags=n.querySelector("h3"),loadJSON(e,function(e){a.json=e,a.manager_videos=new GalleryVideos(document.getElementById("gallery-videos"),e,t,0),a.manager_images=new GalleryImages(document.getElementById("gallery-images"),e,function(){o()}),o()})}function GalleryVideos(e,t,o,a){this.container=e,YouTubeAPIInit();var n=-1;for(var i in t.videos)if(n++,t.videos.hasOwnProperty(i)){var r=t.videos[i],s=document.createElement("div"),l=document.createElement("img"),u=document.createElement("div");l.id="youtube-cover-"+n,u.id="youtube-player-"+n,l.src=t.filebase_covers+r.cover,l.className="video-cover",s.id=i,s.className="video-wrapper gallery-block",s.appendChild(l),s.appendChild(u),this.container.appendChild(s),YouTubeAPIAddPlayer({id:u.id,params:{width:640,height:360,videoId:i,playerVars:{enablejsapi:1,loop:1,start:r.start,playlist:i,autoplay:0,controls:0,showinfo:0,fs:0,rel:0,disablekb:1,modestbranding:1,playsinline:1},events:{onReady:function(e){var t=e.target,n=t.getIframe();function i(){o.isInViewport(n.parentNode,a)?(void 0===t.timer&&(t.timer=null),null!=t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){o.isInViewport(n.parentNode,a)&&t.playVideo()},500)):t.pauseVideo()}t.mute(),t.setPlaybackQuality("small"),t.playVideo(),t.pauseVideo(),i(),window.addEventListener("resize",i),window.addEventListener("scroll",i)},onStateChange:function(e){var t=e.target.getIframe().parentNode.querySelector(".video-cover");switch(e.data){case YT.PlayerState.BUFFERING:t.classList.remove("cover-hidden"),t.classList.add("cover-visible");break;case YT.PlayerState.PLAYING:t.classList.remove("cover-visible"),t.classList.add("cover-hidden")}},onError:function(e){switch(e.data){case 2:console.log("YouTube API error 2");break;case 5:console.log("YouTube API error 5");break;case 100:console.log("YouTube API error 100");break;case 101:console.log("YouTube API error 101");break;case 150:console.log("YouTube API error 150")}}}}})}}function GalleryImages(e,l,u){var c=this;for(var t in c.container=e,c.lightbox=e.querySelector("#lightbox"),c.lightbox_img=e.querySelector("#lightbox-image"),c.lightbox_visible=!1,c.lightbox.onclick=function(e){c.hideLightbox()},c.hideLightbox(),c.layout=new Masonry("#gallery-images",{itemSelector:".gallery-block",columnWidth:".gallery-block",percentPosition:!0,transitionDuration:0,stagger:0,resize:!0}),c.loadstack=[],l.images)l.images.hasOwnProperty(t)&&c.loadstack.push({id:t,data:l.images[t]});!function e(t){if(t<c.loadstack.length){var n=c.loadstack[t].id,i=l.filebase_images+n,o=i.split(".").slice(0,-1).join("."),a=i.substring(o.length,i.length),r=o+"_tumbnail"+a,s=i;c.addImage(n,r,s,function(){u(),e(++t)})}}(0)}function UI(){var t=this;t.ui=document.getElementById("ui"),t.body=document.getElementsByTagName("BODY")[0],window.addEventListener("touchstart",function e(){console.log("User touched !"),t.touch=!0,t.updateButtons(),window.removeEventListener("touchstart",e,!1)},!1),t.updateButtons();var e=t.ui.querySelector("#contact-button"),n=t.ui.querySelector("#contact-email"),i="szontagh";e.href="mailto:andrej."+i+"@gmail.com",n.innerHTML="andrej​.​"+i+" ​@ ​gmail​.​com";var o=document.getElementById("overlay");o.addEventListener("onvisible",function(e){t.ui.classList.add("overlay"),t.body.classList.add("noscroll")},!1),o.addEventListener("onhidden",function(e){t.ui.classList.remove("overlay"),t.body.classList.remove("noscroll")},!1)}Gallery.prototype={constructor:Gallery,manager_videos:null,manager_images:null,desc_header:null,desc_oneliner:null,desc_tags:null,showLightbox:function(e){console.log("showLightbox")},hideLightbox:function(){console.log("hideLightbox")}},GalleryVideos.prototype={constructor:GalleryVideos},GalleryImages.prototype={constructor:GalleryImages,loadstack:[],addImage:function(t,n,i,o){var a=this,r=document.createElement("div"),s=document.createElement("img");r.id=t,r.className="gallery-block",s.setAttribute("src",n),s.setAttribute("src-lightbox",i),r.appendChild(s),a.container.appendChild(r),s.addEventListener("load",function(e){a.layout.appended(e.target.parentNode),a.layout.layout(),o()}),s.addEventListener("error",function(){e.target.remove(),a.layout.layout(),o()})},showLightbox:function(e){this.lightbox.classList.remove("lightbox-hidden"),this.lightbox.classList.add("lightbox-visible"),this.lightbox_img.setAttribute("src",e.getAttribute("src")),this.lightbox_img.setAttribute("src-lazy",e.getAttribute("src-lightbox")),this.lightbox_img.onload=function(e){var t=e.target;t.src=t.getAttribute("src-lazy")},this.lightbox_visible=!0},hideLightbox:function(){this.lightbox.classList.remove("lightbox-visible"),this.lightbox.classList.add("lightbox-hidden"),this.lightbox_visible=!1}},UI.prototype={constructor:UI,touch:!1,body:null,ui:null,parseButtonStateRef:function(e){var t={value:null,value_ext:null,value_readonly:!1},n=e.getAttribute("button-state");return n&&((n=n.trim())&&0<n.length&&"["===n.charAt(0)&&"]"===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1),t.value_readonly=!0),"on"===n&&(t.value="on"),"off"!==n&&""!==n||(t.value="off"),n&&0<n.length&&"{"===n.charAt(0)&&"}"===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1),t.value_ext=n)),t},setButtonState:function(e,t,n){n=void 0===n||n;var i=this;if(e.classList.contains("button-hover")||e.classList.contains("button-press")){if(i.parseButtonStateRef(e).value_readonly||e.setAttribute("button-state",t),!0===n){var o=e.getAttribute("button-clear");if(null!==o)for(var a=i.body.querySelectorAll(o),r=0;r<a.length;r++)a[r]!==e&&"on"===i.getButtonState(a[r])&&i.setButtonState(a[r],"off",!1)}if("on"===t){if(!0===n)if(null!==(s=e.getAttribute("button-set-on")))for(a=i.body.querySelectorAll(s),r=0;r<a.length;r++)a[r]!==e&&i.setButtonState(a[r],t,!1);i.showButtonTargets(e,"button-target",!0)}if("off"===t){var s;if(!0===n)if(null!==(s=e.getAttribute("button-set-off")))for(a=i.body.querySelectorAll(s),r=0;r<a.length;r++)a[r]!==e&&i.setButtonState(a[r],t,!1);i.showButtonTargets(e,"button-target",!1)}}},getButtonState:function(e){var t=this.parseButtonStateRef(e);if("on"===t.value||"off"===t.value)return t.value;if(null!==t.value_ext){var n=this.body.querySelector(attr);if(n){var i=this.parseButtonStateRef(n);if("on"===i.value||"off"===i.value)return i.value}}return"off"},showButtonTargets:function(e,t,n){var i=e.getAttribute(t);if(i){var o=[],a=(i=i.trim()).indexOf("<this>");if(0<=a&&(i=(i=i.substr(0,a)+i.substr(a+"<this>".length)).trim(),o.push(e)),i){var r=this.body.querySelectorAll(i);r&&(o=o.concat(Array.prototype.slice.call(r)))}if(null!=o)for(var s=0;s<o.length;s++){var l=o[s];n?(l.classList.remove("hidden"),l.classList.add("visible"),l.dispatchEvent(new Event("onvisible"))):(l.classList.remove("visible"),l.classList.add("hidden"),l.dispatchEvent(new Event("onhidden")))}}},clearButtonEvents:function(e){e.removeEventListener("mouseenter",e.___button_listener_mouseenter),e.removeEventListener("mouseleave",e.___button_listener_mouseleave),e.removeEventListener("mousedown",e.___button_listener_mousedown),e.removeEventListener("mouseup",e.___button_listener_mouseup)},initButton:function(e){var i=this;i.clearButtonEvents(e),null===e.getAttribute("button-state")&&e.setAttribute("button-state","off"),!1===e.classList.contains("hidden")&&!1===e.classList.contains("visible")&&e.classList.add("visible"),e.classList.contains("button-hover")?(e.___button_listener_mouseleave=function(e){i.setButtonState(e.target,"off")},e.___button_listener_mouseenter=function(e){i.setButtonState(e.target,"on"),i.transformButtonByScrolls(e.target)},e.___button_listener_mousedown=function(e){e.target.___callback_open_lightbox&&e.target.___callback_open_lightbox(e)},e.addEventListener("mouseenter",e.___button_listener_mouseenter),e.addEventListener("mouseleave",e.___button_listener_mouseleave),e.addEventListener("mousedown",e.___button_listener_mousedown)):e.classList.contains("button-press")&&(e.___button_listener_mousedown=function(e){var t=e.target,n=i.getButtonState(t);"on"===n?i.setButtonState(t,"off"):"off"===n&&i.setButtonState(t,"on")},e.___button_listener_mouseup=function(e){var t=(new Date).getTime();if(e.target.___button_listener_mouseup_time){var n=t-e.target.___button_listener_mouseup_time;100<n&&n<500&&e.target.___callback_open_lightbox&&e.target.___callback_open_lightbox(e)}e.target.___button_listener_mouseup_time=t},e.addEventListener("mousedown",e.___button_listener_mousedown),e.addEventListener("mouseup",e.___button_listener_mouseup)),e.___callback_open_lightbox||(e.___callback_open_lightbox=function(e){})},transformButton:function(e){e.classList.contains("button-hover")&&(this.clearButtonEvents(e),e.classList.remove("button-hover"),e.classList.add("button-press"),this.initButton(e))},transformButtonByScrolls:function(e){if(e.classList.contains("button-hover")){var t=e.getAttribute("button-scroll");if(null!==t)for(var n=window.innerHeight,i=this.body.querySelectorAll(t),o=0;o<i.length;o++){var a=i[o].getBoundingClientRect();if(a.top+a.height>n){this.transformButton(e);break}}}},updateButtons:function(){for(var e=this.body.querySelectorAll(".button-hover, .button-press"),t=0;t<e.length;t++){var n=e[t];this.touch?this.transformButton(n):this.initButton(n)}}};var manager_ui=null,manager_animations=null,manager_gallery=null;window.onload=function(e){manager_ui=new UI,manager_animations=new Animations,manager_gallery=new Gallery(manager_ui,manager_animations,"data/gallery.json")};