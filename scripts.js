const t=Math.sqrt(1.61803398875);function n(){}function o(){}n.prototype={triggers:[],constructor:n,applyLiveCSSAnimations:function(){for(var t=this,e=document.getElementsByTagName("*"),n=e.length;n--;){var o=e[n],a=window.getComputedStyle(o);if(p=a.getPropertyValue("--anim-play")){for(var i=a.getPropertyValue("--anim-init"),r=a.getPropertyValue("--anim-class"),s=a.getPropertyValue("--anim-trigger"),l=a.getPropertyValue("--anim-edge"),c=a.getPropertyValue("--anim-delay-min"),d=a.getPropertyValue("--anim-delay-max"),u=!1,m=0;m<t.triggers.length;m++){if((v=t.triggers[m]).target.contains(o)&&v.anim_play===p&&v.anim_init===i&&v.anim_class===r&&v.anim_trigger===s&&v.anim_edge===l&&v.anim_delay_min===c&&v.anim_delay_max===d){u=!0;break}if(o.contains(v.target)&&v.anim_play===p&&v.anim_init===i&&v.anim_class===r&&v.anim_trigger===s&&v.anim_edge===l&&v.anim_delay_min===c&&v.anim_delay_max===d){t.triggers.splice(m,1);break}}u||t.triggers.push({target:o,anim_play:p,anim_init:i,anim_class:r,anim_trigger:s,anim_edge:l,anim_delay_min:c,anim_delay_max:d})}}function g(){for(var e=[],n=0;n<t.triggers.length;n++){var o=t.triggers[n],a=o.target,i=o.anim_trigger,r=o.anim_init,s=o.anim_class,l=o.anim_play,c=o.anim_edge;isInViewport(i,c)?(r&&a.classList.remove(r),s?a.classList.add(s):a.style.setProperty("animation-name",l)):e.push(o)}t.triggers=e}for(n=0;n<t.triggers.length;n++){var v,_=(v=t.triggers[n]).target,p=v.anim_play;i=v.anim_init,r=v.anim_class,s=v.anim_trigger,l=v.anim_edge,c=v.anim_delay_min,d=v.anim_delay_max;i&&_.classList.add(i),c&&d&&(c=parseFloat(c),d=parseFloat(d),_.style.setProperty("animation-delay",c+(d-c)*Math.random()+"s")),v.anim_trigger=s="self"===s?_:document.getElementById(s),v.anim_edge=l=l?parseFloat(l):0}g(),window.addEventListener("resize",g),window.addEventListener("scroll",g),this.applyLiveCSSAnimations=null},isInViewport:function(t,e){var n=window.innerHeight,o=t.getBoundingClientRect(),a=n*Math.min(e,.4),i=o.top-a,r=o.bottom-a;return!(i>(n-=2*a)||r<0)}},o.prototype={constructor:o,initialized:!1,sealed:!1,apiready:!1,queue:[],players:[],init:function(){if(0==this.initialized){this.initialized=!0;var t=document.createElement("script");t.id="iframe-api",t.src="https://www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}},debug:function(){for(var t=0;t<this.players.length;t++){var e=this.players[t].getPlayerState();switch(e){case YT.PlayerState.ENDED:e="ended";break;case YT.PlayerState.PLAYING:e="playing";break;case YT.PlayerState.PAUSED:e="paused";break;case YT.PlayerState.BUFFERING:e="buffering";break;case YT.PlayerState.CUED:e="cued";break;default:e="unstarted"}console.log("Player "+t+" >> "+e)}},addPlayer:function(t){this.queue.push(t)},createPlayers:function(){var t=this;if(t.sealed=!0,t.initialized&&t.apiready){!function e(){if(t.queue.length>0){var n=t.queue.shift(),o=new YT.Player(n.id,n.params);t.players.push(o),o.addEventListener("onStateChange",function t(n){n.data===YT.PlayerState.PLAYING&&(n.target.removeEventListener(n.type,t),setTimeout(e,1e3))})}}()}}};var o=new o;class a{constructor(){var t=this;t.content_overflow=document.getElementById("content-overflow"),t.content_transform=document.getElementById("content-transform"),t.content=document.getElementById("content"),t.gallery=new l("data/gallery.json")}}class i extends a{constructor(){super();this.crop_scrolltop=0,this.cropped=!1}cropIn(t,e){var n=this;n.content_transform.getBoundingClientRect();n.crop_scrolltop=document.scrollingElement.scrollTop,n.content_transform.style.height="calc(100vh + "+(t+e)+"px)",n.content.style.top=-(n.crop_scrolltop-t)+"px",document.scrollingElement.scrollTop=t,f.classList.add("has-crop"),n.cropped=!0}cropOut(){var t=this;t.content_transform.style.height=null,t.content.style.top=null,document.scrollingElement.scrollTop=t.crop_scrolltop,f.classList.remove("has-crop"),t.crop_scrolltop=-1,t.cropped=!1}}class r extends i{constructor(){super();var t=this;t.zoomed_at=null,t.zooming=!1,window.addEventListener("resize",function(e){t.content.addEventListener("layoutComplete",function e(n){n.target.removeEventListener(n.type,e),requestAnimationFrame(function(){!function(e){if(t.zoomed_at){var n=t.zoomed_at;t.content_transform.style.transition="none",t.zoomOut();var o=t.content_transform.getBoundingClientRect(),a=n.getBoundingClientRect(),i=window.innerHeight;window.innerWidth,document.documentElement.scrollTop=a.top-o.top-.5*(i-a.height),t.zoomIn(n),t.content_transform.style.transition=null}}()})})})}zoomIn(e,n){var o=this,a=window.innerHeight,i=window.innerWidth,r=e.getBoundingClientRect(),s=r.top<0?-r.top:0,l=r.bottom>a?r.bottom-a:0;o.cropIn(s,l);var c=r.left+.5*r.width,d=r.top+.5*r.height,u=t,m=u*r.width/i,g=u*r.height/a,v=Math.max(i*Math.max(.75,m)/r.width,a*Math.max(.75,g)/r.height),_=.5*i-c,p=.5*a-d;d+=s,o.content_transform.style.transform="translateX("+_+"px) translateY("+p+"px) scale("+v+") rotate(5deg)",o.content_transform.style.transformOrigin=c+"px "+d+"px ",o.content_transform.classList.add("focusing"),o.content_transform.addEventListener("animationend",function t(e){e.target===o.content_transform&&"focusing"===e.animationName&&(e.target.removeEventListener(e.type,t),o.content_transform.classList.remove("focusing"))}),f.classList.add("has-zoom"),o.zoomed_at=e,o.zooming=!0,n?(f.classList.add("is-zooming-in"),o.content_transform.addEventListener("transitionend",function t(e){e.target===o.content_transform&&"transform"===e.propertyName&&(e.target.removeEventListener(e.type,t),f.classList.remove("is-zooming-in"),o.zooming=!1,n(e))})):o.zooming=!1}zoomOut(t){var e=this;e.zoomed_at&&(e.content_transform.style.transform=null,e.content_transform.classList.add("focusing"),e.content_transform.addEventListener("animationend",function t(n){n.target===e.content_transform&&"focusing"===n.animationName&&(n.target.removeEventListener(n.type,t),e.content_transform.classList.remove("focusing"))})),e.zooming=!0,t?(f.classList.add("is-zooming-out"),e.content_transform.addEventListener("transitionend",function n(o){o.target===e.content_transform&&"transform"===o.propertyName&&(o.target.removeEventListener(o.type,n),e.zooming=!1,e.zoomed_at=null,f.classList.remove("is-zooming-out"),f.classList.remove("has-zoom"),e.cropOut(),t(o))})):(e.zooming=!1,e.zoomed_at=null,f.classList.remove("has-zoom"),e.cropOut())}}class s extends r{constructor(){super()}}class l{constructor(t){var e,n,a,i=this;function r(){var t=document.querySelectorAll(".gallery-block");if(t)for(var e=0;e<t.length;e++){var n=t[e];0==n.classList.contains("button-hover")&&(n.classList.add("button-hover"),n.classList.add("hidden"),n.setAttribute("button-target","<this> #label-description"),n.setAttribute("button-clear",".gallery-block"),n.addEventListener("onvisible",function(t){var e,n=null,o=t.target.id;if((e=i.json.images[o])?n=e.description:(e=i.json.videos[o])&&(n=e.description),n)if(n=i.json.descriptions[n]){if(i.desc_header.innerHTML=n.name+"<br> ("+n.year+")",i.desc_oneliner.innerHTML=n.oneliner,i.desc_tags.innerHTML="",n.tags)for(var a=0;a<n.tags.length;a++)a>0&&(i.desc_tags.innerHTML+=" - "),i.desc_tags.innerHTML+=n.tags[a]}else i.desc_header.innerHTML="",i.desc_oneliner.innerHTML="",i.desc_tags.innerHTML=""}),n.___callback_open=function(t){!1===L.zooming&&(i.lightbox.isVisible()?i.lightbox.hide():i.lightbox.show(t.target))})}y.updateButtons()}o.init(),i.manager_videos=null,i.manager_images=null,i.lightbox=null,i.desc=document.getElementById("label-description"),i.container=document.getElementById("content-transform"),i.desc_header=i.desc.querySelector("h1"),i.desc_oneliner=i.desc.querySelector("p"),i.desc_tags=i.desc.querySelector("h3"),e=t,n=function(t){i.json=t,i.manager_videos=new c(document.getElementById("gallery-videos"),t,b,0),i.manager_images=new d(document.getElementById("gallery-images"),t,function(){r()}),i.lightbox=new u(t),r()},(a=new XMLHttpRequest).overrideMimeType("application/json"),a.open("GET",e,!0),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&n(JSON.parse(a.responseText))},a.send(null)}}class c{constructor(t,e,n,a){this.container=t,o.init();var i=-1;for(var r in e.videos)if(i++,e.videos.hasOwnProperty(r)){var s=e.videos[r],l=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),u=document.createElement("img"),m=document.createElement("div"),g=document.createElement("img");m.setAttribute("index",i),l.id=r,c.id="YouTube-"+r,l.className="video-wrapper gallery-block",c.className="youtube-player",d.className="video-cover visible",m.className="video-progressbar",u.src=e.filebase_covers+s.cover,g.src=e.filebase_covers+s.cover,d.appendChild(u),d.appendChild(m),m.appendChild(g),l.appendChild(d),l.appendChild(c),this.container.appendChild(l),g.addEventListener("load",function(t){var e=t.target.parentNode,n=parseFloat(e.getAttribute("index"));e.style.setProperty("--progress","98%"),e.style.transitionDelay=(1+Math.random())*n+"s",e.style.transitionDuration=20+10*Math.random()+"s"}),o.addPlayer({id:c.id,params:{width:640,height:360,videoId:r,playerVars:{enablejsapi:1,loop:1,start:s.start,playlist:r,autoplay:1,controls:0,showinfo:0,fs:0,rel:0,disablekb:1,modestbranding:1,playsinline:1},events:{onReady:function(t){var e=t.target,o=e.getIframe(),i=o.parentNode.querySelector(".video-cover"),r=o.parentNode.querySelector(".video-progressbar");function s(t){var e=t.getIframe().parentNode;n.isInViewport(e,a)&&(t.playVideo(),e.style.visibility="visible")}function l(){i.classList.contains("hidden")&&(n.isInViewport(o.parentNode,a)?s(e):(e.pauseVideo(),o.parentNode.style.visibility="hidden"))}function c(){if(!0===i.classList.contains("visible")){function t(){i.classList.add("hidden")}r.style.setProperty("--progress","100%"),r.style.transitionDuration="0.5s",r.style.transitionDelay=null,i.classList.remove("visible"),e&&e.pauseVideo(),r.addEventListener("transitionend",function n(o){(o.target===r&&"clip-path"===o.propertyName||"width"===o.propertyName)&&(o.target.removeEventListener(o.type,n),s(e),setTimeout(t,100))})}}e.mute(),e.setPlaybackQuality("small"),e.playVideo(),window.addEventListener("resize",l),window.addEventListener("scroll",l),e.addEventListener("onStateChange",function t(e){e.data===YT.PlayerState.PLAYING&&(e.target.removeEventListener(e.type,t),c())})},onStateChange:function(t){t.target.getIframe();switch(t.data){case YT.PlayerState.BUFFERING:case YT.PlayerState.PLAYING:}},onError:function(t){switch(t.data){case 2:console.log("YouTube API error 2");break;case 5:console.log("YouTube API error 5");break;case 100:console.log("YouTube API error 100");break;case 101:console.log("YouTube API error 101");break;case 150:console.log("YouTube API error 150")}}}}})}o.createPlayers()}}class d{constructor(t,e,n){var o=this;for(var a in o.json=e,o.container=t,o.layout=new Masonry("#gallery-images",{itemSelector:".gallery-block",columnWidth:".gallery-block",percentPosition:!0,transitionDuration:0,stagger:0,resize:!0}),o.layout.on("layoutComplete",function(t){L.content&&L.content.dispatchEvent(new Event("layoutComplete",{detail:t}))}),o.loadstack=[],e.images)e.images.hasOwnProperty(a)&&o.loadstack.push({id:a,data:e.images[a]});!function t(a){if(a<o.loadstack.length){var i=o.loadstack[a].id,r=e.filebase_images+i,s=r.split(".").slice(0,-1).join("."),l=r.substring(s.length,r.length),c=s+"_tumbnail"+l,d=r;o.addImage(i,c,d,function(){n(),t(++a)})}}(0)}addImage(t,n,o,a){var i=this,r=document.createElement("div"),s=document.createElement("img");r.id=t,r.className="gallery-block",s.setAttribute("src",n),s.setAttribute("src-lightbox",o),s.setAttribute("srcset",n+" 500w, "+o+" 1000w"),r.appendChild(s),i.container.appendChild(r),s.addEventListener("load",function(t){i.layout.appended(t.target.parentNode),i.layout.layout(),a()}),s.addEventListener("error",function(){e.target.remove(),i.layout.layout(),a()})}}class u{constructor(t){var e=this;e.json=t,e.container=document.getElementById("screen-lightbox"),e.details=e.container.querySelector("#details"),e.details_timer=null,e.details_index=0,e.target=null,e.container.addEventListener("onvisible",function(t){e.onVisible()}),e.container.addEventListener("onhidden",function(t){e.onHidden()})}resetDetails(){var t=this;t.details_timer&&clearTimeout(t.details_timer),t.details.style.visibility="hidden",t.details.innerHTML="",t.details_index=0}playDetails(t,e,n){var o=this;o.resetDetails();var a,i=null;if((a=o.json.images[t])?i=a.description:(a=o.json.videos[t])&&(i=a.description),i&&(i=o.json.descriptions[i])){function r(t){t.target.removeEventListener(t.type,r),o.details.classList.remove("roll-off"),o.details.classList.add("roll-on"),o.details.addEventListener("animationend",s),function(){o.details_index>=i.details.length&&(o.details_index=0);var t=i.details[o.details_index++];o.details.innerHTML="";for(var e=0;e<t.length;e++)o.details.innerHTML+=t[e];o.details.style.visibility="visible"}()}function s(t){t.target.removeEventListener(t.type,s),o.details_timer&&clearTimeout(o.details_timer),o.details_timer=setTimeout(l,n)}function l(){o.details.classList.remove("roll-on"),o.details.classList.add("roll-off"),o.details.addEventListener("animationend",r)}o.details_timer=setTimeout(l,e)}}onVisible(){var t=this;t.target&&(L.zoomIn(t.target,function(t){}),L.zoomed_at&&(L.zoomed_at.classList.add("in-lightbox"),t.playDetails(L.zoomed_at.id,0,2e3)))}onHidden(){var t=this;L.zoomed_at&&L.zoomed_at.classList.remove("in-lightbox"),L.zoomOut(function(e){t.resetDetails()})}isVisible(t){return this.container.classList.contains("visible")}show(t){var e=this;e.target=t,e.container.classList.remove("hidden"),e.container.classList.add("visible"),e.container.dispatchEvent(new Event("onvisible"))}hide(){var t=this;t.container.classList.remove("visible"),t.container.classList.add("hidden"),t.container.dispatchEvent(new Event("onhidden"))}}class m{constructor(){var t=this;t.touch=!1,t.ui=document.getElementById("ui"),window.addEventListener("touchstart",function e(){t.touch=!0,t.updateButtons(),window.removeEventListener("touchstart",e,!1)},!1),t.updateButtons()}updateButtons(){for(var t=this,e=f.querySelectorAll(".button-hover, .button-press"),n=0;n<e.length;n++){var o=e[n];t.touch?t.transformButton(o):t.initButton(o)}}initButton(t){null===t.getAttribute("button-state")&&t.setAttribute("button-state","off"),!1===t.classList.contains("hidden")&&!1===t.classList.contains("visible")&&t.classList.add("visible")}transformButton(t){t.classList.contains("button-hover")&&(this.clearButtonEvents(t),t.classList.remove("button-hover"),t.classList.add("button-press"),this.initButton(t))}transformButtonByScrolls(t){if(t.classList.contains("button-hover")){var e=t.getAttribute("button-scroll");if(null!==e)for(var n=window.innerHeight,o=f.querySelectorAll(e),a=0;a<o.length;a++){if(o[a].getBoundingClientRect().height>n){this.transformButton(t);break}}}}}class g extends m{constructor(){super()}setButtonState(t,e,n){var o=this;if(n=void 0===n||n,t.classList.contains("button-hover")||t.classList.contains("button-press")){if(o.parseButtonStateRef(t).value_readonly||t.setAttribute("button-state",e),!0===n){var a=t.getAttribute("button-clear");if(null!==a)for(var i=f.querySelectorAll(a),r=0;r<i.length;r++)i[r]!==t&&"on"===o.getButtonState(i[r])&&o.setButtonState(i[r],"off",!1)}if("on"===e){if(!0===n)if(null!==(s=t.getAttribute("button-set-on")))for(i=f.querySelectorAll(s),r=0;r<i.length;r++)i[r]!==t&&o.setButtonState(i[r],e,!1);o.showButtonTargets(t,"button-target",!0)}if("off"===e){var s;if(!0===n)if(null!==(s=t.getAttribute("button-set-off")))for(i=f.querySelectorAll(s),r=0;r<i.length;r++)i[r]!==t&&o.setButtonState(i[r],e,!1);o.showButtonTargets(t,"button-target",!1)}}}getButtonState(t){var e=this.parseButtonStateRef(t);if("on"===e.value||"off"===e.value)return e.value;if(null!==e.value_ext){var n=f.querySelector(attr);if(n){var o=this.parseButtonStateRef(n);if("on"===o.value||"off"===o.value)return o.value}}return"off"}parseButtonStateRef(t){var e={value:null,value_ext:null,value_readonly:!1},n=t.getAttribute("button-state");return n&&((n=n.trim())&&n.length>0&&"["===n.charAt(0)&&"]"===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1),e.value_readonly=!0),"on"===n&&(e.value="on"),"off"!==n&&""!==n||(e.value="off"),n&&n.length>0&&"{"===n.charAt(0)&&"}"===n.charAt(n.length-1)&&(n=n.substring(1,n.length-1),e.value_ext=n)),e}showButtonTargets(t,e,n){}}class v extends g{constructor(){super()}showButtonTargets(t,e,n){super.showButtonTargets(t,e,n);var o=t.getAttribute(e);if(o){var a=[],i=(o=o.trim()).indexOf("<this>");if(i>=0&&(o=(o=o.substr(0,i)+o.substr(i+"<this>".length)).trim(),a.push(t)),o){var r=f.querySelectorAll(o);r&&(a=a.concat(Array.prototype.slice.call(r)))}if(null!=a)for(var s=0;s<a.length;s++){var l=a[s];n?(l.classList.remove("hidden"),l.classList.add("visible"),l.dispatchEvent(new Event("onvisible"))):(l.classList.remove("visible"),l.classList.add("hidden"),l.dispatchEvent(new Event("onhidden")))}}}}class _ extends v{constructor(){super()}initButton(t){super.initButton(t);var e=this;e.clearButtonEvents(t),t.classList.contains("button-hover")?(t.___button_listener_mouseleave=function(t){clearTimeout(t.target.___button_listener_mouseenter_timeout),e.setButtonState(t.target,"off")},t.___button_listener_mouseenter=function(t){clearTimeout(t.target.___button_listener_mouseenter_timeout),t.target.___button_listener_mouseenter_timeout=setTimeout(function(){e.setButtonState(t.target,"on"),e.transformButtonByScrolls(t.target)},100)},t.___button_listener_mousedown=function(t){t.target.___callback_open&&t.target.___callback_open(t)},t.addEventListener("mouseenter",t.___button_listener_mouseenter),t.addEventListener("mouseleave",t.___button_listener_mouseleave),t.addEventListener("mousedown",t.___button_listener_mousedown)):t.classList.contains("button-press")&&(t.___button_listener_mousedown=function(t){var n=t.target,o=e.getButtonState(n);"on"===o?e.setButtonState(n,"off"):"off"===o&&e.setButtonState(n,"on")},t.___button_listener_mouseup=function(t){var e=(new Date).getTime();if(t.target.___button_listener_mouseup_time){var n=e-t.target.___button_listener_mouseup_time;n>100&&n<500&&t.target.___callback_open&&t.target.___callback_open(t)}t.target.___button_listener_mouseup_time=e},t.addEventListener("mousedown",t.___button_listener_mousedown),t.addEventListener("mouseup",t.___button_listener_mouseup)),t.___callback_open||(t.___callback_open=function(t){})}clearButtonEvents(t){t.removeEventListener("mouseenter",t.___button_listener_mouseenter),t.removeEventListener("mouseleave",t.___button_listener_mouseleave),t.removeEventListener("mousedown",t.___button_listener_mousedown),t.removeEventListener("mouseup",t.___button_listener_mouseup)}}class p extends _{constructor(){super()}}class h{constructor(){var t=f.querySelector("#button-contact"),e=f.querySelector("#label-email");t.href="mailto:andrej.szontagh@gmail.com",e.innerHTML="andrej​.​szontagh ​@ ​gmail​.​com";var n={screen:"has-screen"},o="",a=0;for(var i in n)n.hasOwnProperty(i)&&(a++>0&&(o+=", "),o+="."+i);for(var r=document.querySelectorAll(o),s=0;s<r.length;s++){(l=r[s]).addEventListener("onhidden",function(t){for(var e in n)n.hasOwnProperty(e)&&t.target.classList.contains(e)&&f.classList.remove(n[e])},!1),l.addEventListener("onvisible",function(t){for(var e in n)n.hasOwnProperty(e)&&t.target.classList.contains(e)&&f.classList.add(n[e])},!1)}for(r=document.querySelectorAll(".screen"),s=0;s<r.length;s++){(l=r[s]).addEventListener("onvisible",function(t){var e=t.target.querySelector(".scroll");e&&(e.parentNode.scrollTop=0)},!1)}for(r=document.querySelectorAll(".scroll"),s=0;s<r.length;s++){var l=r[s],c=window.getComputedStyle(l),d=c.getPropertyValue("--scroll-pos-min"),u=c.getPropertyValue("--scroll-pos-max");function m(t){var e=window.innerHeight,n=l.getBoundingClientRect(),o=n.height>e?Math.abs(n.top)/(n.height-e):0;o=Math.min(Math.max((o-d)/(u-d),0),1),l.style.setProperty("--scroll-pos",o)}d=d?parseFloat(d):0,u=u?parseFloat(u):1,l.parentNode.addEventListener("scroll",m)}}}var f=null,y=null,b=null,L=null;window.onload=function(t){f=document.getElementsByTagName("BODY")[0],y=new p,new h,b=new n,L=new s};